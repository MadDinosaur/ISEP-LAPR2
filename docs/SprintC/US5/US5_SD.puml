@startuml

autonumber

actor MedicalLabTechnician as mlt
participant SampleUI as UI
participant SampleController as Controller
participant Company
participant TestStore
participant ":TestMapper" as TestMapper
participant Barbecue as API
participant Sample
participant SampleStore

activate mlt
mlt -> UI: requests to record new collected sample(s)
activate UI
UI -> Controller: getTestList()
activate Controller
Controller -> Company: getTestList()
activate Company
Company -> TestStore: getUnusedTests()
deactivate Company
Controller -> TestMapper: toDTO(listTest)
deactivate Controller
deactivate Company
UI --> mlt: shows list of tests
deactivate UI
mlt -> UI: selects test
activate UI
UI -> Controller: selectTestCode(testCode)
activate Controller
deactivate Company
UI --> mlt: requests number of samples to record
deactivate UI
mlt -> UI: gives number of samples to record
activate UI
UI --> mlt: request confirmation
deactivate UI
mlt -> UI: gives confirmation
activate UI

UI -> Controller: setSampleNumber(n)
Controller -> SampleStore: setTestCode(testCode)
activate SampleStore
loop loop for n times
Controller -> API: generateBarcode()
activate API
API -> Controller: newBarcode(barcode)
deactivate API
Controller -> Sample: cs = createSample(barcode)
deactivate Controller
activate Sample
Sample -> SampleStore: saveSample(Sample sample)
deactivate Sample
end loop
SampleStore -> TestStore: mudar estado do test used
deactivate SampleStore
UI --> mlt: shows (in)success of operation
deactivate UI
deactivate mlt

@enduml